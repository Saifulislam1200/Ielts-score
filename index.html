<!-- file: ielts-4-card-calculator.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>IELTS Score Calculator · 4 Cards</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .gauge-arc { transition: stroke-dasharray .5s ease; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-amber-50 via-white to-slate-100 text-slate-900">
  <div class="mx-auto max-w-6xl px-6 pb-28 pt-10">
    <!-- Header -->
    <header class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
      <div>
        <h1 class="text-3xl font-bold tracking-tight">IELTS Score Calculator</h1>
        <p class="mt-1 text-sm text-slate-600">4 cards — Listening, Reading, Writing, Speaking. Overall updates live (rounded to the nearest 0.5).</p>
      </div>
      <div id="modeSegment" class="inline-flex rounded-xl border border-slate-200 bg-white p-1 shadow-sm">
        <button data-mode="academic" class="rounded-lg px-3 py-1.5 text-sm bg-slate-900 text-white shadow" aria-pressed="true">Academic</button>
        <button data-mode="general"  class="rounded-lg px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100" aria-pressed="false">General</button>
      </div>
    </header>

    <!-- 4 Cards -->
    <main class="mt-8 grid grid-cols-1 gap-6 md:grid-cols-2">
      <!-- Listening -->
      <section class="rounded-xl border border-slate-200 bg-white/80 p-6 shadow-sm backdrop-blur-sm">
        <h2 class="text-lg font-semibold">Listening</h2>
        <p class="mt-1 text-sm text-slate-600">Correct answers (0–40)</p>

        <div class="mt-4 flex items-center gap-2">
          <input id="inListening" type="number" inputmode="numeric" min="0" max="40" step="1" placeholder="e.g. 26"
                 class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-300 focus:ring-2 focus:ring-slate-200"/>
          <button class="btn-dec rounded-lg border border-slate-200 px-2 py-1 text-xs hover:bg-slate-50" data-target="inListening">−</button>
          <button class="btn-inc rounded-lg border border-slate-200 px-2 py-1 text-xs hover:bg-slate-50" data-target="inListening">+</button>
        </div>

        <div class="mt-3 flex items-center justify-between">
          <div class="inline-flex items-center gap-2">
            <span class="text-xs text-slate-500">Band</span>
            <span id="bandListening" class="rounded-full bg-slate-900 px-2.5 py-1 text-sm font-semibold text-white">–</span>
          </div>
          <div class="text-xs text-slate-400">Quick set</div>
        </div>

        <div class="mt-3 flex flex-wrap gap-2">
          <button class="chip preset" data-target="inListening" data-val="12">12</button>
          <button class="chip preset" data-target="inListening" data-val="18">18</button>
          <button class="chip preset" data-target="inListening" data-val="23">23</button>
          <button class="chip preset" data-target="inListening" data-val="26">26</button>
          <button class="chip preset" data-target="inListening" data-val="30">30</button>
          <button class="chip preset" data-target="inListening" data-val="34">34</button>
          <button class="chip preset" data-target="inListening" data-val="37">37</button>
          <button class="chip preset" data-target="inListening" data-val="40">40</button>
        </div>
      </section>

      <!-- Reading -->
      <section class="rounded-xl border border-slate-200 bg-white/80 p-6 shadow-sm backdrop-blur-sm">
        <h2 class="text-lg font-semibold"><span id="readingTitle">Academic</span> Reading</h2>
        <p class="mt-1 text-sm text-slate-600">Correct answers (0–40)</p>

        <div class="mt-4 flex items-center gap-2">
          <input id="inReading" type="number" inputmode="numeric" min="0" max="40" step="1" placeholder="e.g. 23"
                 class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-300 focus:ring-2 focus:ring-slate-200"/>
          <button class="btn-dec rounded-lg border border-slate-200 px-2 py-1 text-xs hover:bg-slate-50" data-target="inReading">−</button>
          <button class="btn-inc rounded-lg border border-slate-200 px-2 py-1 text-xs hover:bg-slate-50" data-target="inReading">+</button>
        </div>

        <div class="mt-3 flex items-center justify-between">
          <div class="inline-flex items-center gap-2">
            <span class="text-xs text-slate-500">Band</span>
            <span id="bandReading" class="rounded-full bg-slate-900 px-2.5 py-1 text-sm font-semibold text-white">–</span>
          </div>
          <div class="text-xs text-slate-400">Quick set</div>
        </div>

        <div class="mt-3 flex flex-wrap gap-2">
          <button class="chip preset" data-target="inReading" data-val="12">12</button>
          <button class="chip preset" data-target="inReading" data-val="18">18</button>
          <button class="chip preset" data-target="inReading" data-val="23">23</button>
          <button class="chip preset" data-target="inReading" data-val="27">27</button>
          <button class="chip preset" data-target="inReading" data-val="30">30</button>
          <button class="chip preset" data-target="inReading" data-val="34">34</button>
          <button class="chip preset" data-target="inReading" data-val="37">37</button>
          <button class="chip preset" data-target="inReading" data-val="40">40</button>
        </div>
      </section>

      <!-- Writing -->
      <section class="rounded-xl border border-slate-200 bg-white/80 p-6 shadow-sm backdrop-blur-sm">
        <h2 class="text-lg font-semibold">Writing</h2>
        <p class="mt-1 text-sm text-slate-600">Band (0–9, step 0.5)</p>

        <div class="mt-4 flex items-center gap-2">
          <input id="inWriting" type="number" min="0" max="9" step="0.5" placeholder="e.g. 6.5"
                 class="w-28 rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-300 focus:ring-2 focus:ring-slate-200"/>
          <button class="btn-dec rounded-lg border border-slate-200 px-2 py-1 text-xs hover:bg-slate-50" data-target="inWriting" data-step="0.5">−</button>
          <button class="btn-inc rounded-lg border border-slate-200 px-2 py-1 text-xs hover:bg-slate-50" data-target="inWriting" data-step="0.5">+</button>
          <span class="ml-auto rounded-full bg-slate-100 px-2 py-1 text-sm">W: <span id="pillW">–</span></span>
        </div>

        <div class="mt-3 flex flex-wrap gap-2">
          <button class="chip bandchip" data-sync="inWriting" data-val="5">5</button>
          <button class="chip bandchip" data-sync="inWriting" data-val="5.5">5.5</button>
          <button class="chip bandchip" data-sync="inWriting" data-val="6">6</button>
          <button class="chip bandchip" data-sync="inWriting" data-val="6.5">6.5</button>
          <button class="chip bandchip" data-sync="inWriting" data-val="7">7</button>
          <button class="chip bandchip" data-sync="inWriting" data-val="7.5">7.5</button>
          <button class="chip bandchip" data-sync="inWriting" data-val="8">8</button>
        </div>
      </section>

      <!-- Speaking -->
      <section class="rounded-xl border border-slate-200 bg-white/80 p-6 shadow-sm backdrop-blur-sm">
        <h2 class="text-lg font-semibold">Speaking</h2>
        <p class="mt-1 text-sm text-slate-600">Band (0–9, step 0.5)</p>

        <div class="mt-4 flex items-center gap-2">
          <input id="inSpeaking" type="number" min="0" max="9" step="0.5" placeholder="e.g. 6"
                 class="w-28 rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-300 focus:ring-2 focus:ring-slate-200"/>
          <button class="btn-dec rounded-lg border border-slate-200 px-2 py-1 text-xs hover:bg-slate-50" data-target="inSpeaking" data-step="0.5">−</button>
          <button class="btn-inc rounded-lg border border-slate-200 px-2 py-1 text-xs hover:bg-slate-50" data-target="inSpeaking" data-step="0.5">+</button>
          <span class="ml-auto rounded-full bg-slate-100 px-2 py-1 text-sm">S: <span id="pillS">–</span></span>
        </div>

        <div class="mt-3 flex flex-wrap gap-2">
          <button class="chip bandchip" data-sync="inSpeaking" data-val="5">5</button>
          <button class="chip bandchip" data-sync="inSpeaking" data-val="5.5">5.5</button>
          <button class="chip bandchip" data-sync="inSpeaking" data-val="6">6</button>
          <button class="chip bandchip" data-sync="inSpeaking" data-val="6.5">6.5</button>
          <button class="chip bandchip" data-sync="inSpeaking" data-val="7">7</button>
          <button class="chip bandchip" data-sync="inSpeaking" data-val="7.5">7.5</button>
          <button class="chip bandchip" data-sync="inSpeaking" data-val="8">8</button>
        </div>

        <div class="mt-6 flex justify-end">
          <button id="btnReset" class="rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm hover:bg-slate-50">Reset All</button>
        </div>
      </section>
    </main>
  </div>

  <!-- Sticky Overall Bar -->
  <aside class="fixed inset-x-0 bottom-0 z-10 border-t border-slate-200 bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/60">
    <div class="mx-auto flex max-w-6xl items-center gap-6 px-6 py-3">
      <div class="relative h-[64px] w-[64px]">
        <svg width="64" height="64">
          <circle cx="32" cy="32" r="26" stroke="#e5e7eb" stroke-width="8" fill="none" stroke-linecap="round"></circle>
          <circle id="gaugeArc" class="gauge-arc" cx="32" cy="32" r="26" stroke="#0f172a" stroke-width="8" fill="none" stroke-linecap="round" stroke-dasharray="0 163.4" transform="rotate(-90 32 32)"></circle>
        </svg>
        <div class="absolute inset-0 grid place-items-center">
          <div id="overallText" class="text-base font-semibold">–</div>
        </div>
      </div>

      <div class="grid flex-1 grid-cols-4 gap-3 text-center text-sm">
        <div class="rounded-lg border border-slate-200 bg-white px-3 py-2 shadow-sm">
          <div class="text-[11px] text-slate-500">Listening</div>
          <div id="statL" class="mt-0.5 font-semibold">–</div>
        </div>
        <div class="rounded-lg border border-slate-200 bg-white px-3 py-2 shadow-sm">
          <div class="text-[11px] text-slate-500">Reading</div>
          <div id="statR" class="mt-0.5 font-semibold">–</div>
        </div>
        <div class="rounded-lg border border-slate-200 bg-white px-3 py-2 shadow-sm">
          <div class="text-[11px] text-slate-500">Writing</div>
          <div id="statW" class="mt-0.5 font-semibold">–</div>
        </div>
        <div class="rounded-lg border border-slate-200 bg-white px-3 py-2 shadow-sm">
          <div class="text-[11px] text-slate-500">Speaking</div>
          <div id="statS" class="mt-0.5 font-semibold">–</div>
        </div>
      </div>

      <div class="hidden text-xs text-slate-500 sm:block">Overall Band (nearest 0.5)</div>
    </div>
  </aside>

  <script>
    // --- Conversion tables ---
    const listeningTable=[{min:39,max:40,score:9},{min:37,max:38,score:8.5},{min:35,max:36,score:8},{min:32,max:34,score:7.5},{min:30,max:31,score:7},{min:26,max:29,score:6.5},{min:23,max:25,score:6},{min:18,max:22,score:5.5},{min:16,max:17,score:5},{min:13,max:15,score:4.5},{min:10,max:12,score:4}];
    const academicReadingTable=[{min:39,max:40,score:9},{min:37,max:38,score:8.5},{min:35,max:36,score:8},{min:33,max:34,score:7.5},{min:30,max:32,score:7},{min:27,max:29,score:6.5},{min:23,max:26,score:6},{min:19,max:22,score:5.5},{min:15,max:18,score:5},{min:13,max:14,score:4.5},{min:10,max:12,score:4}];
    const generalReadingTable=[{min:40,max:40,score:9},{min:39,max:39,score:8.5},{min:37,max:38,score:8},{min:36,max:36,score:7.5},{min:34,max:35,score:7},{min:32,max:33,score:6.5},{min:30,max:31,score:6},{min:27,max:29,score:5.5},{min:23,max:26,score:5},{min:19,max:22,score:4.5},{min:15,max:18,score:4}];

    // --- DOM ---
    const seg=document.getElementById('modeSegment');
    const readingTitle=document.getElementById('readingTitle');

    const inListening=document.getElementById('inListening');
    const inReading=document.getElementById('inReading');
    const inWriting=document.getElementById('inWriting');
    const inSpeaking=document.getElementById('inSpeaking');

    const bandListening=document.getElementById('bandListening');
    const bandReading=document.getElementById('bandReading');

    const pillW=document.getElementById('pillW');
    const pillS=document.getElementById('pillS');

    const statL=document.getElementById('statL');
    const statR=document.getElementById('statR');
    const statW=document.getElementById('statW');
    const statS=document.getElementById('statS');

    const overallText=document.getElementById('overallText');
    const arc=document.getElementById('gaugeArc');

    const btnReset=document.getElementById('btnReset');

    // --- State ---
    let mode='academic';

    // --- Utils ---
    const clamp=(n,min,max)=>Math.min(max,Math.max(min,n));
    const roundHalf=(n)=>Math.round(n*2)/2;
    function fmt(n){ return n==null||n===''?'–':Number(n).toString(); }
    function readNum(el){ const v=el.value.trim(); if(v==='') return null; const n=Number(v); return Number.isFinite(n)?n:null; }
    function getBand(table,correct){ for(const r of table) if(correct>=r.min && correct<=r.max) return r.score; return 0; }

    const C=2*Math.PI*26; // gauge circumference (r=26)

    function update(){
      const lRaw=readNum(inListening);
      const rRaw=readNum(inReading);
      const w=readNum(inWriting);
      const s=readNum(inSpeaking);

      const lBand=lRaw==null?null:getBand(listeningTable,clamp(Math.round(lRaw),0,40));
      const rBand=rRaw==null?null:getBand(mode==='academic'?academicReadingTable:generalReadingTable,clamp(Math.round(rRaw),0,40));

      bandListening.textContent=fmt(lBand);
      bandReading.textContent=fmt(rBand);
      pillW.textContent=fmt(w);
      pillS.textContent=fmt(s);

      statL.textContent=fmt(lBand);
      statR.textContent=fmt(rBand);
      statW.textContent=fmt(w);
      statS.textContent=fmt(s);

      if(lBand!=null && rBand!=null && w!=null && s!=null){
        const overall=roundHalf((lBand+rBand+w+s)/4);
        overallText.textContent=String(overall).replace(/\.0$/,'');
        const pct=clamp(overall/9,0,1);
        arc.setAttribute('stroke-dasharray',`${(C*pct).toFixed(1)} ${C.toFixed(1)}`);
      } else {
        overallText.textContent='–';
        arc.setAttribute('stroke-dasharray',`0 ${C.toFixed(1)}`);
      }
    }

    // Wire raw inputs
    [inListening,inReading].forEach(el=>{
      el.addEventListener('input',update);
      el.addEventListener('blur',()=>{ if(el.value!=='') el.value=String(clamp(Math.round(Number(el.value)),0,40)); update(); });
    });

    // Wire band inputs
    [inWriting,inSpeaking].forEach(el=>{
      el.addEventListener('input',update);
      el.addEventListener('blur',()=>{ if(el.value!=='') el.value=String(roundHalf(clamp(Number(el.value),0,9))); update(); });
    });

    // Segmented
    seg.querySelectorAll('button').forEach(btn=>{
      btn.addEventListener('click',()=>{
        seg.querySelectorAll('button').forEach(b=>{ b.classList.remove('bg-slate-900','text-white','shadow'); b.classList.add('text-slate-700','hover:bg-slate-100'); b.setAttribute('aria-pressed','false'); });
        btn.classList.add('bg-slate-900','text-white','shadow'); btn.classList.remove('text-slate-700','hover:bg-slate-100'); btn.setAttribute('aria-pressed','true');
        mode=btn.dataset.mode; readingTitle.textContent=mode==='academic'?'Academic':'General';
        update();
      });
    });

    // Steppers
    document.querySelectorAll('.btn-inc,.btn-dec').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const id=btn.getAttribute('data-target');
        const step=Number(btn.getAttribute('data-step')||1);
        const el=document.getElementById(id);
        const min=Number(el.min||0), max=Number(el.max||40);
        const cur=readNum(el);
        const sign=btn.classList.contains('btn-inc')?1:-1;
        const next=(cur==null?min:cur)+sign*step;
        const snapped=step===1?Math.round(next):roundHalf(next);
        el.value=String(clamp(snapped,min,max));
        update();
      });
    });

    // Presets + band chips
    const chipStyle="rounded-full border border-slate-200 bg-white px-3 py-1 text-xs text-slate-700 hover:bg-slate-50";
    document.querySelectorAll('.chip').forEach(b=>b.className+=' '+chipStyle);
    document.querySelectorAll('.preset').forEach(btn=>{
      btn.addEventListener('click',()=>{ const el=document.getElementById(btn.dataset.target); el.value=btn.dataset.val; update(); });
    });
    document.querySelectorAll('.bandchip').forEach(btn=>{
      btn.addEventListener('click',()=>{ const el=document.getElementById(btn.getAttribute('data-sync')); el.value=btn.getAttribute('data-val'); update(); });
    });

    // Reset
    btnReset.addEventListener('click',()=>{ [inListening,inReading,inWriting,inSpeaking].forEach(el=>el.value=''); update(); });

    // First paint
    update();
  </script>
</body>
</html>
